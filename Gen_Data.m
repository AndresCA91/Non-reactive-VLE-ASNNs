clear
clc
format long

%% Data File Generation - The data must be in the same orderform suggested in the Data.xls
% Additional molar components can be added if the structure is followed as
% shown in the Data.xls file
% Copy/Paste the table from the Data.xls in the X brackets

X = [
0.0405	0.9595	0.173	0.827	283.15	12.665625	15.32796568	10.11171456	NaN
0.08	0.92	0.308	0.692	283.15	15.87869408	15.32796568	10.11171456	NaN
0.554	0.446	0.602	0.398	283.15	19.54505921	15.32796568	10.11171456	NaN
0.588	0.412	0.611	0.389	283.15	19.91836184	15.32796568	10.11171456	NaN
0.616	0.384	0.624	0.376	283.15	20.265	15.32796568	10.11171456	NaN
0.634	0.366	0.631	0.369	283.15	20.38499013	15.32796568	10.11171456	NaN
0.723	0.277	0.649	0.351	283.15	19.81170395	15.32796568	10.11171456	NaN
0.924	0.076	0.785	0.215	283.15	17.51855921	15.32796568	10.11171456	NaN
0.027	0.973	0.141	0.859	308.15	34.41050329	46.30108693	30.76512828	NaN
0.053	0.947	0.241	0.759	308.15	41.30326974	46.30108693	30.76512828	NaN
0.516	0.484	0.613	0.387	308.15	55.23545724	46.30108693	30.76512828	NaN
0.619	0.381	0.632	0.368	308.15	58.66184211	46.30108693	30.76512828	NaN
0.6625	0.3375	0.644	0.356	308.15	59.03514474	46.30108693	30.76512828	NaN
0.695	0.305	0.6585	0.3415	308.15	58.92848684	46.30108693	30.76512828	NaN
0.729	0.271	0.673	0.327	308.15	58.84849342	46.30108693	30.76512828	NaN
0.876	0.124	0.755	0.245	308.15	56.39536184	46.30108693	30.76512828	NaN
0.0076	0.9924	0.0687	0.9313	308.15	NaN	46.30108693	30.76512828	NaN
0.013	0.987	0.079	0.921	308.15	NaN	46.30108693	30.76512828	NaN
0.027	0.973	0.1323	0.8677	308.15	NaN	46.30108693	30.76512828	NaN
0.8987	0.1013	0.7788	0.2212	308.15	NaN	46.30108693	30.76512828	NaN
0.9031	0.0969	0.7823	0.2177	308.15	NaN	46.30108693	30.76512828	NaN
0.9065	0.0935	0.7864	0.2136	308.15	NaN	46.30108693	30.76512828	NaN
0.9191	0.0809	0.7966	0.2034	308.15	NaN	46.30108693	30.76512828	NaN
0.9288	0.0712	0.8126	0.1874	308.15	NaN	46.30108693	30.76512828	NaN
0.9347	0.0653	0.8254	0.1746	308.15	NaN	46.30108693	30.76512828	NaN
0.9432	0.0568	0.8532	0.1468	308.15	NaN	46.30108693	30.76512828	NaN
0.9543	0.0457	0.8684	0.1316	308.15	NaN	46.30108693	30.76512828	NaN
0.9606	0.0394	0.8896	0.1104	308.15	NaN	46.30108693	30.76512828	NaN
0.0385	0.9615	0.2328	0.762	313.15	47.19211875	56.35557322	37.44482345	NaN
0.054	0.946	0.2869	0.7131	313.15	50.16520757	56.35557322	37.44482345	NaN
0.0782	0.9218	0.349	0.651	313.15	53.91023289	56.35557322	37.44482345	NaN
0.1224	0.8776	0.4222	0.5778	313.15	58.91248816	56.35557322	37.44482345	NaN
0.1417	0.8583	0.4446	0.5554	313.15	60.78833388	56.35557322	37.44482345	NaN
0.1916	0.8084	0.4874	0.5126	313.15	63.96673914	56.35557322	37.44482345	NaN
0.195	0.805	0.4898	0.5102	313.15	64.14672434	56.35557322	37.44482345	NaN
0.2369	0.7631	0.5149	0.4851	313.15	66.14522664	56.35557322	37.44482345	NaN
0.2469	0.7531	0.52	0.48	313.15	66.53586118	56.35557322	37.44482345	NaN
0.2534	0.7466	0.5231	0.4769	313.15	66.73984441	56.35557322	37.44482345	NaN
0.2964	0.7036	0.5418	0.4582	313.15	68.09706612	56.35557322	37.44482345	NaN
0.314	0.686	0.5485	0.4515	313.15	68.37837632	56.35557322	37.44482345	NaN
0.3497	0.6503	0.5609	0.4391	313.15	69.31029967	56.35557322	37.44482345	NaN
0.3859	0.6141	0.5722	0.4278	313.15	69.78226086	56.35557322	37.44482345	NaN
0.4125	0.5875	0.5722	0.4278	313.15	70.27955329	56.35557322	37.44482345	NaN
0.4366	0.5634	0.5864	0.4136	313.15	70.5728625	56.35557322	37.44482345	NaN
0.4948	0.5052	0.6013	0.3987	313.15	71.22347566	56.35557322	37.44482345	NaN
0.555	0.445	0.616	0.384	313.15	71.53411678	56.35557322	37.44482345	NaN
0.6145	0.3855	0.6309	0.3691	313.15	71.71943487	56.35557322	37.44482345	NaN
0.6633	0.3367	0.6441	0.3559	313.15	71.72076809	56.35557322	37.44482345	NaN
0.7897	0.2103	0.6921	0.3079	313.15	70.7021852	56.35557322	37.44482345	NaN
0.876	0.124	0.7543	0.2457	313.15	68.09173322	56.35557322	37.44482345	NaN
0.9262	0.0738	0.8175	0.1825	313.15	65.23730132	56.35557322	37.44482345	NaN
0.9401	0.0599	0.8412	0.1588	313.15	63.94807401	56.35557322	37.44482345	NaN
0.9645	0.0355	0.8925	0.1075	313.15	61.46694474	56.35557322	37.44482345	NaN
0.095	0.905	0.29	0.71	329.35	101.325	101.5750747	67.34821656	NaN
0.21	0.79	0.485	0.515	322.15	101.325	78.84716347	52.34432858	NaN
0.32	0.68	0.54	0.46	324.75	101.325	86.5298404	57.4214681	NaN
0.37	0.63	0.56	0.44	322.75	101.325	80.56974049	53.48321038	NaN
0.52	0.48	0.57	0.43	322.15	101.325	78.84716347	52.34432858	NaN
0.53	0.47	0.575	0.425	322.15	101.325	78.84716347	52.34432858	NaN
0.6	0.4	0.57	0.43	322.15	101.325	78.84716347	52.34432858	NaN
0.805	0.195	0.62	0.38	321.15	101.325	76.04170156	50.48885185	NaN
0.93	0.07	0.72	0.28	324.15	101.325	84.70608707	56.21675271	NaN
0.0513	0.9487	NaN	NaN	298.15	NaN	30.53619871	20.26588102	409.89
0.0671	0.9329	NaN	NaN	298.15	NaN	30.53619871	20.26588102	498.23
0.0771	0.9229	NaN	NaN	298.15	NaN	30.53619871	20.26588102	572.75
0.1466	0.8534	NaN	NaN	298.15	NaN	30.53619871	20.26588102	917.33
0.1748	0.8252	NaN	NaN	298.15	NaN	30.53619871	20.26588102	1047.54
0.3587	0.6413	NaN	NaN	298.15	NaN	30.53619871	20.26588102	1517.72
0.5561	0.4439	NaN	NaN	298.15	NaN	30.53619871	20.26588102	1576.75
0.7357	0.2643	NaN	NaN	298.15	NaN	30.53619871	20.26588102	1209.15
0.8988	0.1012	NaN	NaN	298.15	NaN	30.53619871	20.26588102	551.4
0.1	0.9	NaN	NaN	253.15	NaN	2.892636476	1.839004361	657.33
0.2	0.8	NaN	NaN	253.15	NaN	2.892636476	1.839004361	1021.58
0.3	0.7	NaN	NaN	253.15	NaN	2.892636476	1.839004361	1222.55
0.4	0.6	NaN	NaN	253.15	NaN	2.892636476	1.839004361	1327.22
0.5	0.5	NaN	NaN	253.15	NaN	2.892636476	1.839004361	1352.34
0.6	0.4	NaN	NaN	253.15	NaN	2.892636476	1.839004361	1310.47
0.7	0.3	NaN	NaN	253.15	NaN	2.892636476	1.839004361	1193.24
0.8	0.2	NaN	NaN	253.15	NaN	2.892636476	1.839004361	967.15
0.9	0.1	NaN	NaN	253.15	NaN	2.892636476	1.839004361	586.15
0.1	0.9	NaN	NaN	273.15	NaN	9.215503366	6.03179212	686.64
0.2	0.8	NaN	NaN	273.15	NaN	9.215503366	6.03179212	1084.38
0.3	0.7	NaN	NaN	273.15	NaN	9.215503366	6.03179212	1327.22
0.4	0.6	NaN	NaN	273.15	NaN	9.215503366	6.03179212	1444.45
0.5	0.5	NaN	NaN	273.15	NaN	9.215503366	6.03179212	1465.38
0.6	0.4	NaN	NaN	273.15	NaN	9.215503366	6.03179212	1410.95
0.7	0.3	NaN	NaN	273.15	NaN	9.215503366	6.03179212	1264.41
0.8	0.2	NaN	NaN	273.15	NaN	9.215503366	6.03179212	1004.83
0.9	0.1	NaN	NaN	273.15	NaN	9.215503366	6.03179212	590.34
0.1	0.9	NaN	NaN	293.15	NaN	24.49085799	16.23170211	711.76
0.2	0.8	NaN	NaN	293.15	NaN	24.49085799	16.23170211	1138.81
0.3	0.7	NaN	NaN	293.15	NaN	24.49085799	16.23170211	1398.39
0.4	0.6	NaN	NaN	293.15	NaN	24.49085799	16.23170211	1540.74
0.5	0.5	NaN	NaN	293.15	NaN	24.49085799	16.23170211	1557.49
0.6	0.4	NaN	NaN	293.15	NaN	24.49085799	16.23170211	1486.31
0.7	0.3	NaN	NaN	293.15	NaN	24.49085799	16.23170211	1335.59
0.8	0.2	NaN	NaN	293.15	NaN	24.49085799	16.23170211	1046.7
0.9	0.1	NaN	NaN	293.15	NaN	24.49085799	16.23170211	615.46
0.09988	0.90012	NaN	NaN	303.15	NaN	37.75245585	25.07576986	774.14
0.1815	0.8185	NaN	NaN	303.15	NaN	37.75245585	25.07576986	1217.52
0.3073	0.6927	NaN	NaN	303.15	NaN	37.75245585	25.07576986	1469.57
0.3996	0.6004	NaN	NaN	303.15	NaN	37.75245585	25.07576986	1524.83
0.5048	0.4952	NaN	NaN	303.15	NaN	37.75245585	25.07576986	1598.1
0.6985	0.3015	NaN	NaN	303.15	NaN	37.75245585	25.07576986	1357.78
0.9038	0.0962	NaN	NaN	303.15	NaN	37.75245585	25.07576986	686.64
0.1771	0.8229	NaN	NaN	313.15	NaN	56.35557322	37.44482345	1382.06
0.3011	0.6989	NaN	NaN	313.15	NaN	56.35557322	37.44482345	1637.46
0.3925	0.6075	NaN	NaN	313.15	NaN	56.35557322	37.44482345	1765.15
0.488	0.512	NaN	NaN	313.15	NaN	56.35557322	37.44482345	1867.73
0.6919	0.3081	NaN	NaN	313.15	NaN	56.35557322	37.44482345	1581.35
0.8105	0.1895	NaN	NaN	313.15	NaN	56.35557322	37.44482345	1308.79
];

n         = round(size(X,2)-3)/3; % Number of components
x         = X(:,1:n); % Molar compositions of the liquid phase
y         = X(:,n+1:2*n); % Molar compositions of the vapor phase
T         = X(:,2*n+1); % Temperature (K)
P         = X(:,2*n+2); % Total pressure (kPa)
Pi        = y.*P; % Partial pressure (kPa)
Psat      = X(:,2*n+3:3*n+2); % Saturation pressure (kPa)
HEX       = X(:,3*n+3); % Excess enthalpy (kJ/mol K)
HEXRT2n   = -HEX./(8.314*T.^2); % Reduced excess enthalpy (-HEX/RT^2)

%% Export Data

save('Data')
